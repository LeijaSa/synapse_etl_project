{
	"name": "exceldataflow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Excellibrary2014",
						"type": "DatasetReference"
					},
					"name": "data2014"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2015",
						"type": "DatasetReference"
					},
					"name": "data2015"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2016",
						"type": "DatasetReference"
					},
					"name": "data2016"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2017",
						"type": "DatasetReference"
					},
					"name": "data2017"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2018",
						"type": "DatasetReference"
					},
					"name": "data2018"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2019",
						"type": "DatasetReference"
					},
					"name": "data2019"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2020",
						"type": "DatasetReference"
					},
					"name": "data2020"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2021",
						"type": "DatasetReference"
					},
					"name": "data2021"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2022",
						"type": "DatasetReference"
					},
					"name": "data2022"
				},
				{
					"dataset": {
						"referenceName": "excellibrary2023",
						"type": "DatasetReference"
					},
					"name": "data2023"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "silverlibrarydataflowparquet",
						"type": "DatasetReference"
					},
					"name": "sinktodatalake"
				}
			],
			"transformations": [
				{
					"name": "unionalldata"
				},
				{
					"name": "removeduplicatecolumnsandrenamecolumns"
				},
				{
					"name": "splitkuntaandvuosi"
				},
				{
					"name": "removekuntaliitos"
				},
				{
					"name": "removekuntavuosi"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2014",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2015",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2016",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2017",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2018",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2019",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2020",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2021",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2022",
				"source(output(",
				"          Kokoelmat0 as string,",
				"          Kokoelmat1 as integer,",
				"          {Kokoelmat: Kirjat yhteensä} as integer,",
				"          {Kokoelmat: Suomenkieliset kirjat} as integer,",
				"          {Kokoelmat: Ruotsinkieliset kirjat} as integer,",
				"          {Kokoelmat: Muunkieliset kirjat} as integer,",
				"          {Kokoelmat: Kaunokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Kaunokirjat, lapset} as integer,",
				"          {Kokoelmat: Tietokirjat, aikuiset} as integer,",
				"          {Kokoelmat: Tietokirjat, lapset} as integer,",
				"          {Kokoelmat: Nuotit ja partituurit} as integer,",
				"          {Kokoelmat: Musiikkiäänitteet} as integer,",
				"          {Kokoelmat: Muut äänitteet} as integer,",
				"          {Kokoelmat: Videotallenteet (2018-)} as integer,",
				"          {Kokoelmat: Muut aineistot} as integer,",
				"          {Kokoelmat: Videot (-2017)} as integer,",
				"          {Kokoelmat: CD-Rom-levyt (-2017)} as integer,",
				"          {Kokoelmat: DVD ja Blue-ray -levyt (-2017)} as integer,",
				"          Lainaus as string,",
				"          Kokonaislainaus as integer,",
				"          {Lainaus yhteensä} as integer,",
				"          {Lainaus: Kirjat yhteensä} as integer,",
				"          {Lainaus: Suomenkieliset kirjat} as integer,",
				"          {Lainaus: Ruotsinkieliset kirjat} as integer,",
				"          {Lainaus: Muunkieliset kirjat} as integer,",
				"          {Lainaus: Kaunokirjat, aikuiset} as integer,",
				"          {Lainaus: Kaunokirjat, lapset} as integer,",
				"          {Lainaus: Tietokirjat, aikuiset} as integer,",
				"          {Lainaus: Tietokirjat, lapset} as integer,",
				"          {Lainaus: Nuotit ja partituurit} as integer,",
				"          {Lainaus: Musiikkiäänitteet} as integer,",
				"          {Lainaus: Muut äänitteet} as integer,",
				"          {Lähetetyt kaukolainat (2022-)} as integer,",
				"          {Lainaus: Celian äänikirjat CD-levyina} as integer,",
				"          {Lainaus: Videotallenteet (2018-)} as integer,",
				"          {Lainaus: Muut aineistot} as integer,",
				"          {Lähetetyt kaukolainat (-2021)} as integer,",
				"          {Saadut kaukolainat (-2021)} as integer,",
				"          {Lainaus: Videot (-2017)} as integer,",
				"          {Lainat: CD-rom-levyt (-2017)} as integer,",
				"          {Lainaus: DVD ja Blu-ray-levyt (-2017)} as integer,",
				"          Talous as string,",
				"          {Toimintakulut tilastovuonna} as decimal(12,2),",
				"          {Henkilöstökulut} as decimal(12,2),",
				"          Kirjastoaineistokulut as decimal(12,2),",
				"          {Kirjojen hankintakulut} as decimal(12,2),",
				"          {E-aineistokulut} as decimal(12,2),",
				"          Tilakustannukset as decimal(12,2),",
				"          {Muut kulut} as decimal(12,2),",
				"          {Toimintakulut kuluvan vuoden talousarviossa} as decimal(12,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> data2023",
				"data2014, data2015, data2016, data2017, data2018, data2019, data2020, data2021, data2022, data2023 union(byName: true)~> unionalldata",
				"unionalldata select(mapColumn(",
				"          kunta_vuosi = Kokoelmat0,",
				"          kokoelmat = Kokoelmat1,",
				"          kokoelmat_kirjat_yhteensa = {Kokoelmat: Kirjat yhteensä},",
				"          kokoelmat_suomenkieliset_kirjat = {Kokoelmat: Suomenkieliset kirjat},",
				"          kokoelmat_ruotsinkieliset_kirjat = {Kokoelmat: Ruotsinkieliset kirjat},",
				"          kokoelmat_muunkieliset_kirjat = {Kokoelmat: Muunkieliset kirjat},",
				"          kokoelmat_kaunokirjat_aikuiset = {Kokoelmat: Kaunokirjat, aikuiset},",
				"          kokoelmat_kaunokirjat_lapset = {Kokoelmat: Kaunokirjat, lapset},",
				"          kokoelmat_tietokirjat_aikuiset = {Kokoelmat: Tietokirjat, aikuiset},",
				"          kokoelmat_tietokirjat_lapset = {Kokoelmat: Tietokirjat, lapset},",
				"          kokoelmat_nuotit_ja_partituurit = {Kokoelmat: Nuotit ja partituurit},",
				"          kokoelmat_musiikkiaanitteet = {Kokoelmat: Musiikkiäänitteet},",
				"          kokoelmat_muut_aanitteet = {Kokoelmat: Muut äänitteet},",
				"          kokoelmat_videotallenteet = {Kokoelmat: Videotallenteet (2018-)},",
				"          kokoelmat_muut_aineistot = {Kokoelmat: Muut aineistot},",
				"          kokoelmat_videot = {Kokoelmat: Videot (-2017)},",
				"          kokoelmat_cd_rom_levyt = {Kokoelmat: CD-Rom-levyt (-2017)},",
				"          kokoelmat_dvd_ja_blue_ray_levyt = {Kokoelmat: DVD ja Blue-ray -levyt (-2017)},",
				"          kokonaislainaus = Kokonaislainaus,",
				"          lainaus_yhteensa = {Lainaus yhteensä},",
				"          lainaus_kirjat_yhteensa = {Lainaus: Kirjat yhteensä},",
				"          lainaus_suomenkieliset_kirjat = {Lainaus: Suomenkieliset kirjat},",
				"          lainaus_ruotsinkieliset_kirjat = {Lainaus: Ruotsinkieliset kirjat},",
				"          lainaus_muunkieliset_kirjat = {Lainaus: Muunkieliset kirjat},",
				"          lainaus_kaunokirjat_aikuiset = {Lainaus: Kaunokirjat, aikuiset},",
				"          lainaus_kaunokirjat_lapset = {Lainaus: Kaunokirjat, lapset},",
				"          lainaus_tietokirjat_aikuiset = {Lainaus: Tietokirjat, aikuiset},",
				"          lainaus_tietokirjat_lapset = {Lainaus: Tietokirjat, lapset},",
				"          lainaus_nuotit_ja_partituurit = {Lainaus: Nuotit ja partituurit},",
				"          lainaus_musiikkiaanitteet = {Lainaus: Musiikkiäänitteet},",
				"          lainaus_muut_aanitteet = {Lainaus: Muut äänitteet},",
				"          lahetetyt_kaukolainat = {Lähetetyt kaukolainat (2022-)},",
				"          lainaus_celian_aanikirjat_cd_levyina = {Lainaus: Celian äänikirjat CD-levyina},",
				"          lainaus_videotallenteet = {Lainaus: Videotallenteet (2018-)},",
				"          lainaus_muut_aineistot = {Lainaus: Muut aineistot},",
				"          lahetetyt_kaukolainat = {Lähetetyt kaukolainat (-2021)},",
				"          saadut_kaukolainat = {Saadut kaukolainat (-2021)},",
				"          lainaus_videot = {Lainaus: Videot (-2017)},",
				"          lainat_cd_rom_levyt = {Lainat: CD-rom-levyt (-2017)},",
				"          lainaus_dvd_ja_blu_ray_levyt = {Lainaus: DVD ja Blu-ray-levyt (-2017)},",
				"          toimintakulut_tilastovuonna = {Toimintakulut tilastovuonna},",
				"          henkilostokulut = {Henkilöstökulut},",
				"          kirjastoaineistokulut = Kirjastoaineistokulut,",
				"          kirjojen_hankintakulut = {Kirjojen hankintakulut},",
				"          e_aineistokulut = {E-aineistokulut},",
				"          tilakustannukset = Tilakustannukset,",
				"          muut_kulut = {Muut kulut},",
				"          toimintakulut_kuluvan_vuoden_talousarviossa = {Toimintakulut kuluvan vuoden talousarviossa}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removeduplicatecolumnsandrenamecolumns",
				"removeduplicatecolumnsandrenamecolumns derive(kunta = split(kunta_vuosi, ',')[1],",
				"          vuosi = split(kunta_vuosi, ', ')[2]) ~> splitkuntaandvuosi",
				"splitkuntaandvuosi derive(kunta = split(kunta, \" \")[1]) ~> removekuntaliitos",
				"removekuntaliitos select(mapColumn(",
				"          kunta,",
				"          vuosi,",
				"          kokoelmat,",
				"          kokoelmat_kirjat_yhteensa,",
				"          kokoelmat_suomenkieliset_kirjat,",
				"          kokoelmat_ruotsinkieliset_kirjat,",
				"          kokoelmat_muunkieliset_kirjat,",
				"          kokoelmat_kaunokirjat_aikuiset,",
				"          kokoelmat_kaunokirjat_lapset,",
				"          kokoelmat_tietokirjat_aikuiset,",
				"          kokoelmat_tietokirjat_lapset,",
				"          kokoelmat_nuotit_ja_partituurit,",
				"          kokoelmat_musiikkiaanitteet,",
				"          kokoelmat_muut_aanitteet,",
				"          kokoelmat_videotallenteet,",
				"          kokoelmat_muut_aineistot,",
				"          kokoelmat_videot,",
				"          kokoelmat_cd_rom_levyt,",
				"          kokoelmat_dvd_ja_blue_ray_levyt,",
				"          kokonaislainaus,",
				"          lainaus_yhteensa,",
				"          lainaus_kirjat_yhteensa,",
				"          lainaus_suomenkieliset_kirjat,",
				"          lainaus_ruotsinkieliset_kirjat,",
				"          lainaus_muunkieliset_kirjat,",
				"          lainaus_kaunokirjat_aikuiset,",
				"          lainaus_kaunokirjat_lapset,",
				"          lainaus_tietokirjat_aikuiset,",
				"          lainaus_tietokirjat_lapset,",
				"          lainaus_nuotit_ja_partituurit,",
				"          lainaus_musiikkiaanitteet,",
				"          lainaus_muut_aanitteet,",
				"          lainaus_celian_aanikirjat_cd_levyina,",
				"          lainaus_videotallenteet,",
				"          lainaus_muut_aineistot,",
				"          lainaus_videot,",
				"          lainat_cd_rom_levyt,",
				"          lainaus_dvd_ja_blu_ray_levyt,",
				"          toimintakulut_tilastovuonna,",
				"          henkilostokulut,",
				"          kirjastoaineistokulut,",
				"          kirjojen_hankintakulut,",
				"          e_aineistokulut,",
				"          tilakustannukset,",
				"          muut_kulut,",
				"          toimintakulut_kuluvan_vuoden_talousarviossa",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removekuntavuosi",
				"removekuntavuosi sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sinktodatalake"
			]
		}
	}
}